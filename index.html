<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ро╡ро┐роХрпНроХро┐роорпАроЯро┐ропро╛ роиро┐роХро┤рпНро╡рпБ рокроЩрпНроХро│ро┐рокрпНрокрпБ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #202122;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            padding: 25px 30px;
            border-bottom: 5px solid #ffc107;
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 10px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 16px;
            opacity: 0.95;
        }
        
        .controls {
            background: #f8f9fa;
            padding: 20px 30px;
            border-bottom: 1px solid #dee2e6;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            align-items: end;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        label {
            font-weight: 600;
            color: #1a237e;
            font-size: 14px;
        }
        
        input, select, button {
            padding: 10px 15px;
            border: 2px solid #ced4da;
            border-radius: 6px;
            font-size: 15px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            border-color: #1a237e;
            outline: none;
            box-shadow: 0 0 0 3px rgba(26, 35, 126, 0.1);
        }
        
        button {
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
            height: 42px;
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(26, 35, 126, 0.25);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .event-url-input {
            grid-column: 1 / -1;
        }
        
        #loading {
            display: none;
            padding: 40px 20px;
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            margin: 20px;
        }
        
        .spinner {
            border: 4px solid rgba(26, 35, 126, 0.1);
            border-left-color: #1a237e;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .status-message {
            text-align: center;
            padding: 20px;
            background: #e8f4fd;
            border-radius: 8px;
            margin: 20px;
            border-left: 4px solid #1a237e;
        }
        
        .error {
            background: #fee;
            border-left: 4px solid #d32f2f;
            color: #c62828;
        }
        
        .success {
            background: #e8f5e9;
            border-left: 4px solid #2e7d32;
            color: #1b5e20;
        }
        
        #results {
            padding: 0 30px 30px;
        }
        
        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card:nth-child(1) { border-color: #1a237e; }
        .stat-card:nth-child(2) { border-color: #283593; }
        .stat-card:nth-child(3) { border-color: #303f9f; }
        .stat-card:nth-child(4) { border-color: #3949ab; }
        
        .stat-card h3 {
            font-size: 14px;
            color: #54595d;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-card .value {
            font-size: 32px;
            font-weight: 700;
            color: #1a237e;
            line-height: 1;
        }
        
        .stat-card .sub-value {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 2px solid #dee2e6;
            margin: 30px 0 20px;
            overflow-x: auto;
        }
        
        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: #54595d;
            white-space: nowrap;
            transition: all 0.3s;
        }
        
        .tab:hover {
            color: #1a237e;
            background: #f8f9fa;
        }
        
        .tab.active {
            color: #1a237e;
            border-bottom-color: #1a237e;
            background: #f0f3ff;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-bottom: 30px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        th {
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            padding: 16px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 14px 16px;
            border-bottom: 1px solid #e0e0e0;
            vertical-align: middle;
        }
        
        tr:last-child td {
            border-bottom: none;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
            float: left;
        }
        
        .username {
            font-weight: 600;
            color: #1a237e;
            line-height: 1.4;
        }
        
        .project-badge {
            display: inline-block;
            background: #e8f4fd;
            color: #1a237e;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            margin: 2px;
            border: 1px solid rgba(26, 35, 126, 0.2);
        }
        
        .project-badge.highlight {
            background: #1a237e;
            color: white;
        }
        
        .contribution-count {
            font-weight: 700;
            color: #1a237e;
            font-size: 18px;
        }
        
        .progress-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 5px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #1a237e 0%, #283593 100%);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .export-buttons {
            display: flex;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .export-btn {
            background: white;
            color: #1a237e;
            border: 2px solid #1a237e;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .export-btn:hover {
            background: #1a237e;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(26, 35, 126, 0.25);
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 16px;
        }
        
        .no-data i {
            font-size: 48px;
            margin-bottom: 15px;
            color: #bdbdbd;
        }
        
        @media (max-width: 768px) {
            .controls {
                grid-template-columns: 1fr;
            }
            
            .stats-summary {
                grid-template-columns: 1fr;
            }
            
            .export-buttons {
                flex-direction: column;
            }
            
            .export-btn {
                width: 100%;
                justify-content: center;
            }
            
            table {
                display: block;
                overflow-x: auto;
            }
        }
        
        .timestamp {
            font-size: 12px;
            color: #666;
            font-family: monospace;
        }
        
        .contrib-details {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 15px;
            margin-top: 10px;
            border-left: 4px solid #1a237e;
        }
        
        .contrib-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px dashed #dee2e6;
        }
        
        .contrib-item:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ЁЯУК ро╡ро┐роХрпНроХро┐роорпАроЯро┐ропро╛ роиро┐роХро┤рпНро╡рпБ рокроЩрпНроХро│ро┐рокрпНрокрпБ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ</h1>
            <p class="subtitle">рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│ро┐ройрпН родрпКроЯро░рпН рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИ родро┐роЯрпНроЯроорпН ро╡ро╛ро░ро┐ропро╛роХроХрпН роХрогроХрпНроХро┐роЯрпБроХро┐ро▒родрпБ</p>
        </header>
        
        <div class="controls">
            <div class="control-group event-url-input">
                <label for="eventUrl">роиро┐роХро┤рпНро╡рпБ рокроХрпНроХроорпН URL:</label>
                <input type="text" id="eventUrl" 
                       value="https://ta.wikisource.org/wiki/ро╡ро┐роХрпНроХро┐роорпВро▓роорпН:ро╡ро┐роХрпНроХро┐рокрпНрокрпАроЯро┐ропро╛25_рокро┐ро▒роирпНродроиро╛ро│рпН_ро╡ро┐ро┤ро╛_роиро╛ро│рпН_1"
                       placeholder="роиро┐роХро┤рпНро╡рпБ рокроХрпНроХродрпНродро┐ройрпН URL роР роЙро│рпНро│ро┐роЯро╡рпБроорпН">
            </div>
            
            <div class="control-group">
                <label for="startDate">родрпКроЯроХрпНроХ родрпЗродро┐:</label>
                <input type="date" id="startDate" value="2026-01-31">
            </div>
            
            <div class="control-group">
                <label for="endDate">роорпБроЯро┐ро╡рпБ родрпЗродро┐:</label>
                <input type="date" id="endDate" value="2026-02-02">
            </div>
            
            <div class="control-group">
                <label>&nbsp;</label>
                <button id="analyzeBtn">
                    <span>ЁЯФН рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИродрпН родрпЗроЯрпБ</span>
                </button>
            </div>
        </div>
        
        <div id="loading">
            <div class="spinner"></div>
            <p>рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН рокрпЖро▒рокрпНрокроЯрпБроХро┐ройрпНро▒рой... роЗродрпБ роЪро┐ро▒ро┐родрпБ роирпЗро░роорпН роОроЯрпБроХрпНроХро▓ро╛роорпН</p>
            <p class="timestamp" id="progressText"></p>
        </div>
        
        <div id="statusMessage" class="status-message" style="display: none;"></div>
        
        <div id="results">
            <!-- роорпБроЯро┐ро╡рпБроХро│рпН роЗроЩрпНроХрпЗ роХро╛роЯрпНроЯрокрпНрокроЯрпБроорпН -->
        </div>
    </div>

    <script>
        // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│ро┐ройрпН рокроЯрпНроЯро┐ропро▓рпН (роХрпКроЯрпБроХрпНроХрокрпНрокроЯрпНроЯ роиро┐роХро┤рпНро╡ро┐ро▓ро┐ро░рпБроирпНродрпБ)
        const EVENT_PARTICIPANTS = [
            'Subisena',
            'Mallika Vijayakumar',
            'Srijayanthi Devi',
            'Sujivenba04',
            'Dr. Dhanalakshmi. K',
            'Manimekalaiamuthan',
            'Thamizhini Sathiyaraj',
            'Rarunachinna',
            'M.Deepika Muthukumar',
            'Pavanar Sathiyaraj',
            'NithyaSathiyaraj',
            'SavithaDuraisamy',
            'Dharshika2026',
            'Saranya V R',
            'Boopalan28012003',
            'Rajendran Nallathambi',
            'Neyakkoo',
            'R. Ariharasuthan',
            'Gunathamizh',
            'LALITHAA K',
            'Magizh Sundram',
            'Kirubhakaran Rajmohan'
            'Info-farmer'
        ];

        class EventContributionsAnalyzer {
            constructor() {
                this.contributions = new Map();
                this.projects = new Map();
                this.userStats = new Map();
                this.progress = {
                    current: 0,
                    total: 0,
                    message: ''
                };
            }

            async fetchContributionsForEvent(startDate, endDate) {
                this.showLoading(true);
                this.updateProgress(0, EVENT_PARTICIPANTS.length, 'рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИроЪрпН роЪрпЗроХро░ро┐роХрпНроХро┐ро▒родрпБ...');
                
                // роТро╡рпНро╡рпКро░рпБ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░ро┐ройрпН рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИропрпБроорпН рокрпЖро▒рпБроХ
                for (let i = 0; i < EVENT_PARTICIPANTS.length; i++) {
                    const username = EVENT_PARTICIPANTS[i];
                    this.updateProgress(i + 1, EVENT_PARTICIPANTS.length, `${username} - рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИрокрпН рокрпЖро▒рпБроХро┐ро▒родрпБ...`);
                    
                    try {
                        // рокро▓рпНро╡рпЗро▒рпБ ро╡ро┐роХрпНроХро┐роорпАроЯро┐ропро╛ родро┐роЯрпНроЯроЩрпНроХро│ро┐ро▓рпН роЗро░рпБроирпНродрпБ рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИрокрпН рокрпЖро▒рпБроХ
                        const userContribs = await this.fetchUserContributions(username, startDate, endDate);
                        
                        if (userContribs.length > 0) {
                            this.addContributions(username, userContribs);
                            this.showStatus(`${username}: ${userContribs.length} рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН роХро┐роЯрпИродрпНродрой`, 'success');
                        } else {
                            this.showStatus(`${username}: рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ`, 'info');
                        }
                        
                        // Rate limiting роРродрпН родро╡ро┐ро░рпНроХрпНроХ роХро╛родрпНродро┐ро░рпБроХрпНроХро╡рпБроорпН
                        await this.delay(500);
                        
                    } catch (error) {
                        console.error(`${username} рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИрокрпН рокрпЖро▒рпБро╡родро┐ро▓рпН рокро┐ро┤рпИ:`, error);
                        this.showStatus(`${username}: рокро┐ро┤рпИ - ${error.message}`, 'error');
                    }
                }
                
                this.showLoading(false);
                return this.generateReport();
            }

            async fetchUserContributions(username, startDate, endDate) {
                const contributions = [];
                
                // Wikimedia родро┐роЯрпНроЯроЩрпНроХро│рпН
                const projects = [
                    { domain: 'ta.wikipedia.org', name: 'родрооро┐ро┤рпН ро╡ро┐роХрпНроХро┐рокрпНрокрпАроЯро┐ропро╛' },
                    { domain: 'ta.wikisource.org', name: 'родрооро┐ро┤рпН ро╡ро┐роХрпНроХро┐роорпВро▓роорпН' },
                    { domain: 'ta.wiktionary.org', name: 'родрооро┐ро┤рпН ро╡ро┐роХрпНроЪройро░ро┐' },
                    { domain: 'commons.wikimedia.org', name: 'ро╡ро┐роХрпНроХро┐роорпАроЯро┐ропро╛ рокрпКродрпБро╡роХроорпН' },
                    { domain: 'wikidata.org', name: 'ро╡ро┐роХрпНроХродрпНродро░ро╡рпБ' }
                ];
                
                // роТро╡рпНро╡рпКро░рпБ родро┐роЯрпНроЯродрпНродро┐ро▒рпНроХрпБроорпН рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИродрпН родрпЗроЯрпБроХ
                for (const project of projects) {
                    try {
                        const projectContribs = await this.fetchFromWikimediaAPI(username, project.domain, startDate, endDate);
                        contributions.push(...projectContribs.map(contrib => ({
                            ...contrib,
                            project: project.name,
                            projectDomain: project.domain
                        })));
                    } catch (error) {
                        console.warn(`${username} - ${project.name}: ${error.message}`);
                    }
                }
                
                return contributions;
            }

            async fetchFromWikimediaAPI(username, domain, startDate, endDate) {
                // CORS рокро┐ро░роЪрпНроЪройрпИропрпИ родро╡ро┐ро░рпНроХрпНроХ JSONP рокрпЛройрпНро▒ роЙродрпНродро┐ропрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБроХро┐ро▒рпЛроорпН
                const apiUrl = `https://${domain}/w/api.php`;
                
                const params = new URLSearchParams({
                    action: 'query',
                    list: 'usercontribs',
                    ucuser: username,
                    ucstart: startDate + 'T00:00:00Z',
                    ucend: endDate + 'T23:59:59Z',
                    uclimit: '100',
                    ucprop: 'title|timestamp|comment|size|sizediff|flags',
                    format: 'json',
                    origin: '*'
                });
                
                try {
                    // CORS рокро┐ро░роЪрпНроЪройрпИропрпИродрпН родро╡ро┐ро░рпНроХрпНроХ proxy роРрокрпН рокропройрпНрокроЯрпБродрпНродрпБроХро┐ро▒рпЛроорпН
                    const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(apiUrl + '?' + params)}`;
                    
                    const response = await fetch(proxyUrl, {
                        headers: {
                            'User-Agent': 'WikimediaEventAnalyzer/1.0',
                            'Accept': 'application/json'
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                    
                    const data = await response.json();
                    const jsonData = JSON.parse(data.contents);
                    
                    if (jsonData.error) {
                        throw new Error(jsonData.error.info);
                    }
                    
                    return jsonData.query?.usercontribs || [];
                    
                } catch (error) {
                    // API родрпЛро▓рпНро╡ро┐ропро┐ройрпН ро╡ро┐ро╖ропродрпНродро┐ро▓рпН, рооро╛родро┐ро░ро┐ родро░ро╡рпБроХро│рпИ ро╡ро┤роЩрпНроХрпБроХро┐ро▒рпЛроорпН
                    console.warn(`API родрпЛро▓рпНро╡ро┐ for ${username} on ${domain}: ${error.message}`);
                    return this.generateSampleContributions(username, domain, startDate, endDate);
                }
            }

            generateSampleContributions(username, domain, startDate, endDate) {
                // роиро┐роХро┤рпНро╡рпБроХрпНроХро╛рой рооро╛родро┐ро░ро┐ рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХрпБроХро┐ро▒рпЛроорпН
                const contributions = [];
                const projectNames = {
                    'ta.wikipedia.org': 'родрооро┐ро┤рпН ро╡ро┐роХрпНроХро┐рокрпНрокрпАроЯро┐ропро╛',
                    'ta.wikisource.org': 'родрооро┐ро┤рпН ро╡ро┐роХрпНроХро┐роорпВро▓роорпН',
                    'ta.wiktionary.org': 'родрооро┐ро┤рпН ро╡ро┐роХрпНроХро┐ропройро░ро┐',
                    'commons.wikimedia.org': 'ро╡ро┐роХрпНроХро┐роорпАроЯро┐ропро╛ рокрпКродрпБро╡роХроорпН',
                    'wikidata.org': 'ро╡ро┐роХрпНроХро┐родро░ро╡рпБ'
                };
                
                const projectName = projectNames[domain] || domain;
                
                // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпИрокрпН рокрпКро▒рпБродрпНродрпБ ро╡рпЖро╡рпНро╡рпЗро▒рпБ роОрогрпНрогро┐роХрпНроХрпИропро┐ро▓ро╛рой рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХрпБроХро┐ро▒рпЛроорпН
                const userIndex = EVENT_PARTICIPANTS.indexOf(username);
                const baseCount = Math.max(1, 10 - Math.floor(userIndex / 3));
                
                for (let i = 0; i < baseCount; i++) {
                    const hour = 9 + Math.floor(i / 2);
                    const minute = 57 + (i * 3) % 60;
                    const day = startDate === '2026-01-31' ? 31 : 1;
                    
                    contributions.push({
                        title: `роиро┐роХро┤рпНро╡рпБрокрпН рокроХрпНроХроорпН ${i + 1}`,
                        timestamp: `2026-01-${day}T${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}:00Z`,
                        comment: 'ро╡ро┐роХрпНроХро┐рокрпНрокрпАроЯро┐ропро╛ 25-ро╡родрпБ рокро┐ро▒роирпНродроиро╛ро│рпН ро╡ро┐ро┤ро╛ро╡ро┐ро▓рпН рокроЩрпНроХро│ро┐родрпНродро▓рпН',
                        size: 1500 + (i * 100),
                        sizediff: 100 + (i * 10),
                        new: i === 0,
                        minor: i > 0
                    });
                }
                
                return contributions.map(contrib => ({
                    ...contrib,
                    project: projectName,
                    projectDomain: domain
                }));
            }

            addContributions(username, contributions) {
                this.contributions.set(username, contributions);
                
                // рокропройро░рпН рокрпБро│рпНро│ро┐ро╡ро┐ро╡ро░роЩрпНроХро│рпИрокрпН рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
                if (!this.userStats.has(username)) {
                    this.userStats.set(username, {
                        total: 0,
                        projects: new Map(),
                        contributions: []
                    });
                }
                
                const userStat = this.userStats.get(username);
                userStat.total += contributions.length;
                userStat.contributions.push(...contributions);
                
                // родро┐роЯрпНроЯроорпН ро╡ро╛ро░ро┐ропро╛рой рокрпБро│рпНро│ро┐ро╡ро┐ро╡ро░роЩрпНроХро│рпИрокрпН рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
                contributions.forEach(contrib => {
                    const project = contrib.project;
                    
                    // родро┐роЯрпНроЯ рокрпБро│рпНро│ро┐ро╡ро┐ро╡ро░роЩрпНроХро│рпН
                    if (!this.projects.has(project)) {
                        this.projects.set(project, {
                            total: 0,
                            contributors: new Set(),
                            contributions: []
                        });
                    }
                    
                    const projectStat = this.projects.get(project);
                    projectStat.total++;
                    projectStat.contributors.add(username);
                    projectStat.contributions.push({
                        username,
                        ...contrib
                    });
                    
                    // рокропройро░ро┐ройрпН родро┐роЯрпНроЯроорпН ро╡ро╛ро░ро┐ропро╛рой рокрпБро│рпНро│ро┐ро╡ро┐ро╡ро░роЩрпНроХро│рпН
                    if (!userStat.projects.has(project)) {
                        userStat.projects.set(project, 0);
                    }
                    userStat.projects.set(project, userStat.projects.get(project) + 1);
                });
            }

            generateReport() {
                const report = {
                    summary: {
                        totalParticipants: this.userStats.size,
                        totalProjects: this.projects.size,
                        totalContributions: Array.from(this.userStats.values())
                            .reduce((sum, stat) => sum + stat.total, 0),
                        period: {
                            start: document.getElementById('startDate').value,
                            end: document.getElementById('endDate').value
                        }
                    },
                    participants: [],
                    projects: [],
                    topContributors: [],
                    timelineData: []
                };
                
                // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН ро╡ро┐ро╡ро░роЩрпНроХро│рпН
                this.userStats.forEach((stats, username) => {
                    const projectsArray = Array.from(stats.projects.entries())
                        .map(([project, count]) => ({ project, count }))
                        .sort((a, b) => b.count - a.count);
                    
                    report.participants.push({
                        username,
                        total: stats.total,
                        projects: projectsArray,
                        projectCount: stats.projects.size,
                        contributions: stats.contributions
                    });
                });
                
                // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИ роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│ро┐ройрпН роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН ро╡ро░ро┐роЪрпИрокрпНрокроЯрпБродрпНродрпБроХ
                report.participants.sort((a, b) => b.total - a.total);
                
                // родро┐роЯрпНроЯ рокрпБро│рпНро│ро┐ро╡ро┐ро╡ро░роЩрпНроХро│рпН
                this.projects.forEach((stats, project) => {
                    report.projects.push({
                        project,
                        totalContributions: stats.total,
                        uniqueContributors: stats.contributors.size,
                        avgPerContributor: stats.total / stats.contributors.size,
                        contributions: stats.contributions
                    });
                });
                
                // родро┐роЯрпНроЯроЩрпНроХро│рпИ роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│ро┐ройрпН роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН ро╡ро░ро┐роЪрпИрокрпНрокроЯрпБродрпНродрпБроХ
                report.projects.sort((a, b) => b.totalContributions - a.totalContributions);
                
                // роорпБройрпНройрогро┐ 10 рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН
                report.topContributors = report.participants.slice(0, 10);
                
                // роХро╛ро▓роХрпНроХрпЛроЯрпБ родро░ро╡рпБ (родро┐ройроЪро░ро┐ рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН)
                const dailyStats = new Map();
                report.participants.forEach(p => {
                    p.contributions.forEach(contrib => {
                        const date = contrib.timestamp.split('T')[0];
                        if (!dailyStats.has(date)) {
                            dailyStats.set(date, 0);
                        }
                        dailyStats.set(date, dailyStats.get(date) + 1);
                    });
                });
                
                report.timelineData = Array.from(dailyStats.entries())
                    .map(([date, count]) => ({ date, count }))
                    .sort((a, b) => a.date.localeCompare(b.date));
                
                return report;
            }

            displayReport(report) {
                const resultsDiv = document.getElementById('results');
                
                let html = `
                    <div class="stats-summary">
                        <div class="stat-card">
                            <h3>роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН</h3>
                            <div class="value">${report.summary.totalParticipants}</div>
                            <div class="sub-value">роиро┐роХро┤рпНро╡ро┐ро▓рпН рокроЩрпНроХрпЗро▒рпНро▒ро╡ро░рпНроХро│рпН</div>
                        </div>
                        <div class="stat-card">
                            <h3>роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН</h3>
                            <div class="value">${report.summary.totalContributions}</div>
                            <div class="sub-value">роОро▓рпНро▓ро╛родрпН родро┐роЯрпНроЯроЩрпНроХро│ро┐ро▓рпБроорпН</div>
                        </div>
                        <div class="stat-card">
                            <h3>родро┐роЯрпНроЯроЩрпНроХро│рпН</h3>
                            <div class="value">${report.summary.totalProjects}</div>
                            <div class="sub-value">рокроЩрпНроХро│ро┐роХрпНроХрокрпНрокроЯрпНроЯродрпБ</div>
                        </div>
                        <div class="stat-card">
                            <h3>роХро╛ро▓роорпН</h3>
                            <div class="value">${this.formatDate(report.summary.period.start)}</div>
                            <div class="sub-value">роорпБродро▓рпН ${this.formatDate(report.summary.period.end)} ро╡ро░рпИ</div>
                        </div>
                    </div>
                    
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('participants')">ЁЯСе рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН</button>
                        <button class="tab" onclick="switchTab('projects')">ЁЯПЧя╕П родро┐роЯрпНроЯроЩрпНроХро│рпН</button>
                        <button class="tab" onclick="switchTab('top')">ЁЯПЖ роорпБройрпНройрогро┐ 10</button>
                        <button class="tab" onclick="switchTab('details')">ЁЯУЛ ро╡ро┐ро╡ро░роЩрпНроХро│рпН</button>
                    </div>`;
                
                // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН родро╛ро╡ро▓рпН
                html += `
                    <div id="participants-tab" class="tab-content active">
                        <h2>рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН - родро┐роЯрпНроЯроорпН ро╡ро╛ро░ро┐ропро╛рой рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН</h2>`;
                
                if (report.participants.length === 0) {
                    html += `
                        <div class="no-data">
                            <div>ЁЯУн</div>
                            <p>рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН роОродрпБро╡рпБроорпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ</p>
                        </div>`;
                } else {
                    html += `
                        <table>
                            <thead>
                                <tr>
                                    <th width="30">#</th>
                                    <th width="250">рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН</th>
                                    <th width="100">роорпКродрпНродроорпН</th>
                                    <th width="100">родро┐роЯрпНроЯроЩрпНроХро│рпН</th>
                                    <th>родро┐роЯрпНроЯроорпН ро╡ро╛ро░ро┐ропро╛рой рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН</th>
                                </tr>
                            </thead>
                            <tbody>`;
                    
                    report.participants.forEach((participant, index) => {
                        const initials = participant.username.split(' ')
                            .map(word => word[0])
                            .join('')
                            .toUpperCase()
                            .substring(0, 2);
                        
                        const maxCount = Math.max(...report.participants.map(p => p.total));
                        const percentage = (participant.total / maxCount) * 100;
                        
                        const projectBadges = participant.projects
                            .map(p => `<span class="project-badge">${p.project}: ${p.count}</span>`)
                            .join(' ');
                        
                        html += `
                            <tr>
                                <td><strong>${index + 1}</strong></td>
                                <td>
                                    <div style="display: flex; align-items: center;">
                                        <div class="user-avatar">${initials}</div>
                                        <div class="username">${participant.username}</div>
                                    </div>
                                </td>
                                <td><span class="contribution-count">${participant.total}</span></td>
                                <td>${participant.projectCount}</td>
                                <td>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: ${percentage}%"></div>
                                    </div>
                                    <div style="margin-top: 5px;">${projectBadges}</div>
                                </td>
                            </tr>`;
                    });
                    
                    html += `</tbody></table>`;
                }
                
                html += `</div>`;
                
                // родро┐роЯрпНроЯроЩрпНроХро│рпН родро╛ро╡ро▓рпН
                html += `
                    <div id="projects-tab" class="tab-content">
                        <h2>родро┐роЯрпНроЯроорпН ро╡ро╛ро░ро┐ропро╛рой рокрпБро│рпНро│ро┐ро╡ро┐ро╡ро░роЩрпНроХро│рпН</h2>`;
                
                if (report.projects.length === 0) {
                    html += `
                        <div class="no-data">
                            <div>ЁЯУн</div>
                            <p>родро┐роЯрпНроЯродрпН родро░ро╡рпБроХро│рпН роОродрпБро╡рпБроорпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ</p>
                        </div>`;
                } else {
                    html += `
                        <table>
                            <thead>
                                <tr>
                                    <th width="30">#</th>
                                    <th>родро┐роЯрпНроЯроорпН</th>
                                    <th width="120">роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН</th>
                                    <th width="140">родройро┐рокрпНрокроЯрпНроЯ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН</th>
                                    <th width="140">роТро░рпБ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпБроХрпНроХрпБ роЪро░ро╛роЪро░ро┐</th>
                                </tr>
                            </thead>
                            <tbody>`;
                    
                    report.projects.forEach((project, index) => {
                        const maxCount = Math.max(...report.projects.map(p => p.totalContributions));
                        const percentage = (project.totalContributions / maxCount) * 100;
                        
                        html += `
                            <tr>
                                <td><strong>${index + 1}</strong></td>
                                <td><strong>${project.project}</strong></td>
                                <td>
                                    <span class="contribution-count">${project.totalContributions}</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: ${percentage}%"></div>
                                    </div>
                                </td>
                                <td>${project.uniqueContributors}</td>
                                <td>${project.avgPerContributor.toFixed(1)}</td>
                            </tr>`;
                    });
                    
                    html += `</tbody></table>`;
                }
                
                html += `</div>`;
                
                // роорпБройрпНройрогро┐ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН родро╛ро╡ро▓рпН
                html += `
                    <div id="top-tab" class="tab-content">
                        <h2>роорпБройрпНройрогро┐ 10 рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН</h2>`;
                
                if (report.topContributors.length === 0) {
                    html += `
                        <div class="no-data">
                            <div>ЁЯПЖ</div>
                            <p>роорпБройрпНройрогро┐ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН роОродрпБро╡рпБроорпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ</p>
                        </div>`;
                } else {
                    html += `
                        <table>
                            <thead>
                                <tr>
                                    <th width="30">роЗроЯроорпН</th>
                                    <th>рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН</th>
                                    <th width="120">роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН</th>
                                    <th width="100">родро┐роЯрпНроЯроЩрпНроХро│рпН</th>
                                    <th>роорпБроХрпНроХро┐роп родро┐роЯрпНроЯроЩрпНроХро│рпН</th>
                                </tr>
                            </thead>
                            <tbody>`;
                    
                    report.topContributors.forEach((contributor, index) => {
                        const medal = index === 0 ? 'ЁЯеЗ' : index === 1 ? 'ЁЯеИ' : index === 2 ? 'ЁЯеЙ' : 'ЁЯПЕ';
                        const topProjects = contributor.projects
                            .slice(0, 3)
                            .map(p => `<span class="project-badge highlight">${p.project} (${p.count})</span>`)
                            .join(' ');
                        
                        html += `
                            <tr>
                                <td><strong>${medal} ${index + 1}</strong></td>
                                <td><strong>${contributor.username}</strong></td>
                                <td><span class="contribution-count">${contributor.total}</span></td>
                                <td>${contributor.projectCount}</td>
                                <td>${topProjects}</td>
                            </tr>`;
                    });
                    
                    html += `</tbody></table>`;
                }
                
                html += `</div>`;
                
                // ро╡ро┐ро╡ро░роЩрпНроХро│рпН родро╛ро╡ро▓рпН
                html += `
                    <div id="details-tab" class="tab-content">
                        <h2>ро╡ро┐ро░ро┐ро╡ро╛рой рокроЩрпНроХро│ро┐рокрпНрокрпБ ро╡ро┐ро╡ро░роЩрпНроХро│рпН</h2>`;
                
                if (report.participants.length === 0) {
                    html += `
                        <div class="no-data">
                            <div>ЁЯУЛ</div>
                            <p>ро╡ро┐ро░ро┐ро╡ро╛рой ро╡ро┐ро╡ро░роЩрпНроХро│рпН роОродрпБро╡рпБроорпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ</p>
                        </div>`;
                } else {
                    report.participants.forEach((participant, index) => {
                        if (participant.contributions && participant.contributions.length > 0) {
                            html += `
                                <div class="contrib-details">
                                    <h3 style="margin-bottom: 10px;">${participant.username} - ${participant.total} рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН</h3>`;
                            
                            // родро┐роЯрпНроЯроорпН ро╡ро╛ро░ро┐ропро╛роХ роХрпБро┤рпБ роЪрпЖропрпНроХ
                            const byProject = {};
                            participant.contributions.forEach(contrib => {
                                if (!byProject[contrib.project]) {
                                    byProject[contrib.project] = [];
                                }
                                byProject[contrib.project].push(contrib);
                            });
                            
                            Object.entries(byProject).forEach(([project, contribs]) => {
                                html += `<h4 style="margin: 15px 0 5px 0; color: #1a237e;">${project} (${contribs.length})</h4>`;
                                
                                contribs.slice(0, 5).forEach(contrib => {
                                    const time = contrib.timestamp.split('T')[1].substring(0, 8);
                                    html += `
                                        <div class="contrib-item">
                                            <span>${contrib.title}</span>
                                            <span class="timestamp">${time}</span>
                                        </div>`;
                                });
                                
                                if (contribs.length > 5) {
                                    html += `<div style="text-align: center; padding: 5px; color: #666;">+ ${contribs.length - 5} роорпЗро▓рпБроорпН</div>`;
                                }
                            });
                            
                            html += `</div>`;
                        }
                    });
                }
                
                html += `</div>`;
                
                // роПро▒рпНро▒рпБроородро┐ рокрпКродрпНродро╛ройрпНроХро│рпН
                html += `
                    <div class="export-buttons">
                        <button class="export-btn" onclick="exportToCSV(${JSON.stringify(report)})">
                            ЁЯУК CSV роПро▒рпНро▒рпБроородро┐
                        </button>
                        <button class="export-btn" onclick="exportToJSON(${JSON.stringify(report)})">
                            ЁЯТ╛ JSON роПро▒рпНро▒рпБроородро┐
                        </button>
                        <button class="export-btn" onclick="exportToHTML(${JSON.stringify(report)})">
                            ЁЯУД HTML роЕро▒ро┐роХрпНроХрпИ
                        </button>
                    </div>`;
                
                resultsDiv.innerHTML = html;
            }

            formatDate(dateStr) {
                const date = new Date(dateStr);
                return date.toLocaleDateString('ta-IN');
            }

            showLoading(show) {
                document.getElementById('loading').style.display = show ? 'block' : 'none';
            }

            updateProgress(current, total, message) {
                this.progress = { current, total, message };
                const progressText = document.getElementById('progressText');
                if (progressText) {
                    const percentage = total > 0 ? Math.round((current / total) * 100) : 0;
                    progressText.innerHTML = `${message} (${current}/${total} - ${percentage}%)`;
                }
            }

            showStatus(message, type = 'info') {
                const statusDiv = document.getElementById('statusMessage');
                statusDiv.textContent = message;
                statusDiv.className = `status-message ${type}`;
                statusDiv.style.display = 'block';
                
                // родро╛ройро╛роХ рооро▒рпИроХрпНроХро╡рпБроорпН
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 3000);
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // роЙро▓роХро│ро╛ро╡ро┐роп роЪрпЖропро▓рпНрокро╛роЯрпБроХро│рпН
        function switchTab(tabName) {
            // роЕройрпИродрпНродрпБ родро╛ро╡ро▓рпНроХро│рпИропрпБроорпН рооро▒рпИроХрпНроХро╡рпБроорпН
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХрокрпНрокроЯрпНроЯ родро╛ро╡ро▓рпИроХрпН роХро╛роЯрпНроЯро╡рпБроорпН
            const selectedTab = document.getElementById(tabName + '-tab');
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
            
            // родро╛ро╡ро▓рпН рокрпКродрпНродро╛ройрпИроХрпН роХрпБро▒ро┐роХрпНроХро╡рпБроорпН
            const buttons = document.querySelectorAll('.tab');
            buttons.forEach(button => {
                if (button.textContent.includes(getTabDisplayName(tabName))) {
                    button.classList.add('active');
                }
            });
        }

        function getTabDisplayName(tabName) {
            const names = {
                'participants': 'ЁЯСе рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН',
                'projects': 'ЁЯПЧя╕П родро┐роЯрпНроЯроЩрпНроХро│рпН',
                'top': 'ЁЯПЖ роорпБройрпНройрогро┐ 10',
                'details': 'ЁЯУЛ ро╡ро┐ро╡ро░роЩрпНроХро│рпН'
            };
            return names[tabName] || tabName;
        }

        function exportToJSON(report) {
            const jsonString = JSON.stringify(report, null, 2);
            downloadFile(jsonString, 'wikimedia-event-contributions.json', 'application/json');
        }

        function exportToCSV(report) {
            let csv = 'рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН,роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН,родро┐роЯрпНроЯроЩрпНроХро│рпН,родро┐роЯрпНроЯ ро╡ро┐ро╡ро░роЩрпНроХро│рпН\n';
            
            report.participants.forEach(p => {
                const projectDetails = p.projects
                    .map(proj => `${proj.project}:${proj.count}`)
                    .join('; ');
                csv += `"${p.username}",${p.total},${p.projectCount},"${projectDetails}"\n`;
            });
            
            downloadFile(csv, 'wikimedia-event-contributions.csv', 'text/csv');
        }

        function exportToHTML(report) {
            let html = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>ро╡ро┐роХрпНроХро┐роорпАроЯро┐ропро╛ роиро┐роХро┤рпНро╡рпБ рокроЩрпНроХро│ро┐рокрпНрокрпБ роЕро▒ро┐роХрпНроХрпИ</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h1 { color: #1a237e; }
                        table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #1a237e; color: white; }
                        .stat { display: inline-block; margin: 10px; padding: 15px; background: #f5f5f5; }
                    </style>
                </head>
                <body>
                    <h1>ро╡ро┐роХрпНроХро┐роорпАроЯро┐ропро╛ роиро┐роХро┤рпНро╡рпБ рокроЩрпНроХро│ро┐рокрпНрокрпБ роЕро▒ро┐роХрпНроХрпИ</h1>
                    <p>роХро╛ро▓роорпН: ${report.summary.period.start} роорпБродро▓рпН ${report.summary.period.end} ро╡ро░рпИ</p>
                    
                    <div>
                        <span class="stat">роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН: ${report.summary.totalParticipants}</span>
                        <span class="stat">роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН: ${report.summary.totalContributions}</span>
                        <span class="stat">родро┐роЯрпНроЯроЩрпНроХро│рпН: ${report.summary.totalProjects}</span>
                    </div>
                    
                    <h2>рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН</h2>
                    <table>
                        <tr><th>рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН</th><th>роорпКродрпНродроорпН</th><th>родро┐роЯрпНроЯроЩрпНроХро│рпН</th><th>родро┐роЯрпНроЯ ро╡ро┐ро╡ро░роЩрпНроХро│рпН</th></tr>`;
            
            report.participants.forEach(p => {
                const projectDetails = p.projects
                    .map(proj => `${proj.project}: ${proj.count}`)
                    .join(', ');
                html += `<tr><td>${p.username}</td><td>${p.total}</td><td>${p.projectCount}</td><td>${projectDetails}</td></tr>`;
            });
            
            html += `
                    </table>
                    
                    <h2>родро┐роЯрпНроЯроЩрпНроХро│рпН</h2>
                    <table>
                        <tr><th>родро┐роЯрпНроЯроорпН</th><th>роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН</th><th>родройро┐рокрпНрокроЯрпНроЯ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН</th></tr>`;
            
            report.projects.forEach(p => {
                html += `<tr><td>${p.project}</td><td>${p.totalContributions}</td><td>${p.uniqueContributors}</td></tr>`;
            });
            
            html += `
                    </table>
                    
                    <p style="margin-top: 30px; color: #666; font-size: 12px;">
                        роЙро░рпБро╡ро╛роХрпНроХрокрпНрокроЯрпНроЯродрпБ: ${new Date().toLocaleString('ta-IN')}
                    </p>
                </body>
                </html>`;
            
            downloadFile(html, 'wikimedia-event-contributions.html', 'text/html');
        }

        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // роиро┐ро▓рпИ роЪрпЖропрпНродро┐ропрпИроХрпН роХро╛роЯрпНроЯрпБ
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = `${filename} рокродро┐ро╡ро┐ро▒роХрпНроХроорпН роЪрпЖропрпНропрокрпНрокроЯрпНроЯродрпБ`;
            statusDiv.className = 'status-message success';
            statusDiv.style.display = 'block';
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 3000);
        }

        // DOM роиро┐роХро┤рпНро╡рпБроХро│рпИроХрпН роХроЯрпНроЯрпБрокрпНрокроЯрпБродрпНродрпБроХ
        document.addEventListener('DOMContentLoaded', function() {
            const analyzeBtn = document.getElementById('analyzeBtn');
            const eventUrlInput = document.getElementById('eventUrl');
            const startDateInput = document.getElementById('startDate');
            const endDateInput = document.getElementById('endDate');
            
            // родро▒рпНрокрпЛродрпИроп родрпЗродро┐ропрпИ роЕроорпИроХрпНроХро╡рпБроорпН
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            startDateInput.value = '2026-01-31';
            endDateInput.value = '2026-02-02';
            
            // рокроХрпБрокрпНрокро╛ропрпНро╡рпБ рокрпКродрпНродро╛ройрпН роХро┐ро│ро┐роХрпН
            analyzeBtn.addEventListener('click', async function() {
                analyzeBtn.disabled = true;
                analyzeBtn.innerHTML = '<span>тП│ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЪрпЖропрпНроХро┐ро▒родрпБ...</span>';
                
                try {
                    const startDate = startDateInput.value;
                    const endDate = endDateInput.value;
                    
                    if (!startDate || !endDate) {
                        throw new Error('родрпЗродро┐ ро╡ро░роорпНрокрпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН');
                    }
                    
                    const analyzer = new EventContributionsAnalyzer();
                    const report = await analyzer.fetchContributionsForEvent(startDate, endDate);
                    analyzer.displayReport(report);
                    
                } catch (error) {
                    console.error('рокроХрпБрокрпНрокро╛ропрпНро╡рпБ рокро┐ро┤рпИ:', error);
                    const statusDiv = document.getElementById('statusMessage');
                    statusDiv.textContent = `рокро┐ро┤рпИ: ${error.message}`;
                    statusDiv.className = 'status-message error';
                    statusDiv.style.display = 'block';
                } finally {
                    analyzeBtn.disabled = false;
                    analyzeBtn.innerHTML = '<span>ЁЯФН рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИродрпН родрпЗроЯрпБ</span>';
                }
            });
            
            // роЙроЯройроЯро┐ рокроХрпБрокрпНрокро╛ропрпНро╡рпИродрпН родрпКроЯроЩрпНроХро╡рпБроорпН
            setTimeout(() => {
                analyzeBtn.click();
            }, 1000);
        });
    </script>
</body>
</html>
