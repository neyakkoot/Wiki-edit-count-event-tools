<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ро╡ро┐роХрпНроХро┐роорпАроЯро┐ропро╛ рокроЩрпНроХро│ро┐рокрпНрокрпБ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роХро░рпБро╡ро┐</title>
    <style>
        :root {
            --primary: #1a237e;
            --primary-light: #534bae;
            --primary-dark: #000051;
            --secondary: #ffc107;
            --text: #202122;
            --text-light: #54595d;
            --background: #f8f9fa;
            --card-bg: #ffffff;
            --border: #a2a9b1;
            --success: #2e7d32;
            --error: #c62828;
            --warning: #f57c00;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Nirmala UI', 'Latha', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: linear-gradient(135deg, #f5f7fa 0%, #e3e8f0 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 25px 30px;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23000051' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.1;
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 16px;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }
        
        .controls-container {
            padding: 25px 30px;
            background: var(--background);
            border-bottom: 1px solid var(--border);
        }
        
        .input-sections {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 25px;
        }
        
        @media (max-width: 1024px) {
            .input-sections {
                grid-template-columns: 1fr;
            }
        }
        
        .input-section {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .section-title {
            font-size: 18px;
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            font-size: 20px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.3s;
            background: var(--card-bg);
            color: var(--text);
        }
        
        textarea {
            min-height: 150px;
            resize: vertical;
            font-family: monospace;
            line-height: 1.5;
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(26, 35, 126, 0.15);
        }
        
        .date-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 25px;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 160px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
        }
        
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(26, 35, 126, 0.3);
        }
        
        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-secondary:hover:not(:disabled) {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #ff9800 100%);
            color: white;
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        #loading {
            display: none;
            padding: 40px 20px;
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            margin: 20px 30px;
            border-left: 5px solid var(--primary);
        }
        
        .spinner {
            border: 4px solid rgba(26, 35, 126, 0.1);
            border-left-color: var(--primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .status-message {
            padding: 15px 20px;
            border-radius: 8px;
            margin: 0 30px 20px;
            display: none;
            animation: slideIn 0.3s;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .status-success {
            background: #e8f5e9;
            border-left: 5px solid var(--success);
            color: #1b5e20;
        }
        
        .status-error {
            background: #ffebee;
            border-left: 5px solid var(--error);
            color: #b71c1c;
        }
        
        .status-info {
            background: #e3f2fd;
            border-left: 5px solid var(--primary);
            color: #0d47a1;
        }
        
        .status-warning {
            background: #fff3e0;
            border-left: 5px solid var(--warning);
            color: #e65100;
        }
        
        #results {
            padding: 0 30px 30px;
        }
        
        .help-box {
            background: #e8f4fd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            border-left: 5px solid var(--primary);
        }
        
        .help-box h3 {
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .help-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .help-item {
            background: white;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .help-item h4 {
            color: var(--primary-light);
            margin-bottom: 8px;
            font-size: 15px;
        }
        
        .help-item ul {
            padding-left: 20px;
            color: var(--text-light);
        }
        
        .help-item li {
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .participant-count {
            position: absolute;
            top: 25px;
            right: 30px;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            backdrop-filter: blur(10px);
            z-index: 1;
        }
        
        .preset-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .preset-btn {
            padding: 6px 12px;
            background: white;
            border: 1px solid var(--primary);
            border-radius: 4px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .preset-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        .auto-extract-options {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }
        
        .option-btn {
            flex: 1;
            padding: 10px;
            background: white;
            border: 2px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }
        
        .option-btn:hover {
            border-color: var(--primary);
            background: #f0f3ff;
        }
        
        .option-btn.active {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }
        
        .participant-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 10px;
            background: white;
            margin-top: 10px;
        }
        
        .participant-item {
            padding: 8px 12px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .participant-item:last-child {
            border-bottom: none;
        }
        
        .remove-participant {
            color: var(--error);
            background: none;
            border: none;
            cursor: pointer;
            font-size: 18px;
            padding: 0 5px;
        }
        
        .example-text {
            font-size: 12px;
            color: var(--text-light);
            margin-top: 5px;
            font-style: italic;
        }
        
        .user-input-methods {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .method-tab {
            padding: 10px 20px;
            background: white;
            border: 2px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .method-tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .input-method-content {
            display: none;
        }
        
        .input-method-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .contributor-badge {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            margin-right: 5px;
            margin-bottom: 5px;
        }
        
        .stats-preview {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid var(--primary);
        }
        
        .stats-preview h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
        }
        
        .stat-preview {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .stat-preview .value {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .stat-preview .label {
            font-size: 12px;
            color: var(--text-light);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ЁЯУК ро╡ро┐роХрпНроХро┐роорпАроЯро┐ропро╛ рокроЩрпНроХро│ро┐рокрпНрокрпБ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роХро░рпБро╡ро┐</h1>
            <p class="subtitle">роОроирпНродро╡рпКро░рпБ роиро┐роХро┤рпНро╡рпБроХрпНроХрпБрооро╛рой рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│ро┐ройрпН родрпКроЯро░рпН рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИродрпН родро┐роЯрпНроЯроорпН ро╡ро╛ро░ро┐ропро╛роХроХрпН роХрогроХрпНроХро┐роЯрпБроХро┐ро▒родрпБ</p>
            <div class="participant-count">
                <span id="participantCount">0</span> рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН
            </div>
        </header>
        
        <div class="controls-container">
            <div class="input-sections">
                <!-- рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН роЙро│рпНро│рпАроЯрпНроЯрпБрокрпН рокроХрпБродро┐ -->
                <div class="input-section">
                    <div class="section-title">
                        <i>ЁЯСе</i>
                        <span>рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН</span>
                    </div>
                    
                    <div class="user-input-methods">
                        <div class="method-tab active" onclick="switchInputMethod('manual')">тЬНя╕П роХрпИроорпБро▒рпИропро╛роХ</div>
                        <div class="method-tab" onclick="switchInputMethod('paste')">ЁЯУЛ роироХро▓рпЖроЯрпБ/роТроЯрпНроЯрпБ</div>
                        <div class="method-tab" onclick="switchInputMethod('extract')">ЁЯМР рокроХрпНроХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ</div>
                    </div>
                    
                    <!-- роХрпИроорпБро▒рпИ роЙро│рпНро│рпАроЯрпНроЯрпБ роорпБро▒рпИ -->
                    <div id="manual-method" class="input-method-content active">
                        <div class="input-group">
                            <label for="usernameInput">рокропройро░рпН рокрпЖропро░рпИ роЙро│рпНро│ро┐роЯро╡рпБроорпН:</label>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="usernameInput" 
                                       placeholder="роО.роХро╛: Subisena">
                                <button type="button" onclick="addManualParticipant()" 
                                        style="min-width: auto; padding: 10px 20px;">
                                    тЮХ роЪрпЗро░рпНроХрпНроХ
                                </button>
                            </div>
                        </div>
                        
                        <div class="preset-buttons">
                            <small>ро╡ро┐ро░рпИро╡рпБ роЪрпЗро░рпНроХрпНроХ:</small>
                            <button class="preset-btn" onclick="addPresetUser('Subisena')">Subisena</button>
                            <button class="preset-btn" onclick="addPresetUser('Mallika Vijayakumar')">Mallika</button>
                            <button class="preset-btn" onclick="addPresetUser('роирпЗропроХрпНроХрпЛ')">роирпЗропроХрпНроХрпЛ</button>
                            <button class="preset-btn" onclick="addPresetUser('Dr. Dhanalakshmi. K')">Dr. Dhanalakshmi</button>
                            <button class="preset-btn" onclick="clearParticipants()">ЁЯз╣ роЕройрпИродрпНродрпБроорпН роирпАроХрпНроХрпБ</button>
                        </div>
                    </div>
                    
                    <!-- роироХро▓рпЖроЯрпБ/роТроЯрпНроЯрпБ роорпБро▒рпИ -->
                    <div id="paste-method" class="input-method-content">
                        <div class="input-group">
                            <label for="participantsTextarea">рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│ро┐ройрпН рокроЯрпНроЯро┐ропро▓рпИ роТроЯрпНроЯро╡рпБроорпН:</label>
                            <textarea id="participantsTextarea" 
                                      placeholder="роТро╡рпНро╡рпКро░рпБ ро╡ро░ро┐ропро┐ро▓рпБроорпН роТро░рпБ рокропройро░рпН рокрпЖропро░рпН:
--Subisena (рокрпЗроЪрпНроЪрпБ) 09:57, 31 роЪройро╡ро░ро┐ 2026
Mallika Vijayakumar
Srijayanthi Devi
Dr. Dhanalakshmi. K"></textarea>
                            <p class="example-text">
                                роТро╡рпНро╡рпКро░рпБ ро╡ро░ро┐ропро┐ро▓рпБроорпН роТро░рпБ рокропройро░рпН рокрпЖропро░рпН. <code>--</code>, <code>()</code>, родрпЗродро┐роХро│рпН рокрпЛройрпНро▒ро╡рпИ родро╛ройро╛роХро╡рпЗ роЕроХро▒рпНро▒рокрпНрокроЯрпБроорпН.
                            </p>
                        </div>
                        
                        <button type="button" onclick="parsePastedParticipants()" 
                                class="btn-secondary" style="width: 100%;">
                            ЁЯУЛ роТроЯрпНроЯро┐роп рокроЯрпНроЯро┐ропро▓рпИроЪрпН роЪрпЗро░рпНроХрпНроХ
                        </button>
                    </div>
                    
                    <!-- рокроХрпНроХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ рокро┐ро░ро┐родрпНродрпЖроЯрпБроХрпНроХрпБроорпН роорпБро▒рпИ -->
                    <div id="extract-method" class="input-method-content">
                        <div class="input-group">
                            <label for="pageUrl">ро╡ро┐роХрпНроХро┐ рокроХрпНроХроорпН URL:</label>
                            <input type="text" id="pageUrl" 
                                   value="https://ta.wikisource.org/wiki/ро╡ро┐роХрпНроХро┐роорпВро▓роорпН:ро╡ро┐роХрпНроХро┐рокрпНрокрпАроЯро┐ропро╛25_рокро┐ро▒роирпНродроиро╛ро│рпН_ро╡ро┐ро┤ро╛_роиро╛ро│рпН_1"
                                   placeholder="https://ta.wikipedia.org/wiki/рокроХрпНроХроорпН_рокрпЖропро░рпН">
                        </div>
                        
                        <div class="auto-extract-options">
                            <div class="option-btn active" onclick="setExtractionMode('wikitext')">
                                ро╡ро┐роХрпНроХро┐ роЙро░рпИ (роХрпИропрпКрокрпНрокроЩрпНроХро│рпН)
                            </div>
                            <div class="option-btn" onclick="setExtractionMode('participants')">
                                рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН рокроЯрпНроЯро┐ропро▓рпН
                            </div>
                        </div>
                        
                        <button type="button" onclick="extractFromPage()" 
                                class="btn-secondary" style="width: 100%; margin-top: 15px;">
                            ЁЯМР рокроХрпНроХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ рокро┐ро░ро┐родрпНродрпЖроЯрпБ
                        </button>
                    </div>
                    
                    <!-- родро▒рпНрокрпЛродрпИроп рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН -->
                    <div class="input-group">
                        <label>родро▒рпНрокрпЛродрпИроп рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН:</label>
                        <div class="participant-list" id="participantsList">
                            <!-- рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН роЗроЩрпНроХрпЗ роХро╛роЯрпНроЯрокрпНрокроЯрпБроорпН -->
                        </div>
                    </div>
                    
                    <div class="stats-preview">
                        <h4>родро▒рпНрокрпЛродрпИроп рокрпБро│рпНро│ро┐ро╡ро┐ро╡ро░роорпН:</h4>
                        <div class="stats-grid">
                            <div class="stat-preview">
                                <div class="value" id="previewTotal">0</div>
                                <div class="label">рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН</div>
                            </div>
                            <div class="stat-preview">
                                <div class="value" id="previewValid">0</div>
                                <div class="label">роЪрпЖро▓рпНро▓рпБрокроЯро┐ропро╛ройро╡рпИ</div>
                            </div>
                            <div class="stat-preview">
                                <div class="value" id="previewDuplicates">0</div>
                                <div class="label">роироХро▓рпНроХро│рпН</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЕроорпИрокрпНрокрпБроХро│рпН рокроХрпБродро┐ -->
                <div class="input-section">
                    <div class="section-title">
                        <i>тЪЩя╕П</i>
                        <span>рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЕроорпИрокрпНрокрпБроХро│рпН</span>
                    </div>
                    
                    <div class="input-group">
                        <label>роХро╛ро▓ роЕро│ро╡рпБ:</label>
                        <div class="date-inputs">
                            <div>
                                <label for="startDate" style="font-size: 13px;">родрпКроЯроХрпНроХроорпН:</label>
                                <input type="date" id="startDate" value="2026-01-31">
                            </div>
                            <div>
                                <label for="endDate" style="font-size: 13px;">роорпБроЯро┐ро╡рпБ:</label>
                                <input type="date" id="endDate" value="2026-02-02">
                            </div>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="projectsSelect">роЪрпЗро░рпНроХрпНроХ ро╡рпЗрогрпНроЯро┐роп родро┐роЯрпНроЯроЩрпНроХро│рпН:</label>
                        <select id="projectsSelect" multiple size="6">
                            <option value="ta.wikipedia.org" selected>родрооро┐ро┤рпН ро╡ро┐роХрпНроХро┐рокрпНрокрпАроЯро┐ропро╛</option>
                            <option value="ta.wikisource.org" selected>родрооро┐ро┤рпН ро╡ро┐роХрпНроХро┐роорпВро▓роорпН</option>
                            <option value="ta.wiktionary.org" selected>родрооро┐ро┤рпН ро╡ро┐роХрпНроХро┐ропройро░ро┐</option>
                            <option value="ta.wikibooks.org">родрооро┐ро┤рпН ро╡ро┐роХрпНроХро┐роирпВро▓рпНроХро│рпН</option>
                            <option value="commons.wikimedia.org" selected>ро╡ро┐роХрпНроХро┐роорпАроЯро┐ропро╛ рокрпКродрпБро╡роХроорпН</option>
                            <option value="wikidata.org" selected>ро╡ро┐роХрпНроХро┐родро░ро╡рпБ</option>
                            <option value="en.wikipedia.org">роЖроЩрпНроХро┐ро▓ ро╡ро┐роХрпНроХро┐рокрпНрокрпАроЯро┐ропро╛</option>
                            <option value="meta.wikimedia.org">роорпЗроЯрпНроЯро╛-ро╡ро┐роХрпНроХро┐</option>
                        </select>
                        <p class="example-text">
                            Ctrl (Windows) роЕро▓рпНро▓родрпБ Cmd (Mac) ро╡рпИродрпНродрпБроХрпНроХрпКрогрпНроЯрпБ рокро▓ро╡ро▒рпНро▒рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН
                        </p>
                    </div>
                    
                    <div class="input-group">
                        <label for="contributionLimit">роТро░рпБ рокропройро░рпБроХрпНроХрпБ роЕродро┐роХрокроЯрпНроЪ рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН:</label>
                        <input type="number" id="contributionLimit" value="500" min="10" max="5000">
                    </div>
                    
                    <div class="help-box" style="margin-top: 20px;">
                        <h3>ЁЯТб рокропройрпБро│рпНро│ роХрпБро▒ро┐рокрпНрокрпБроХро│рпН</h3>
                        <div class="help-content">
                            <div class="help-item">
                                <h4>рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХ</h4>
                                <ul>
                                    <li>роХрпИроорпБро▒рпИропро╛роХ рокрпЖропро░рпНроХро│рпИ роЙро│рпНро│ро┐роЯро▓ро╛роорпН</li>
                                    <li>рокроЯрпНроЯро┐ропро▓рпИ роироХро▓рпЖроЯрпБродрпНродрпБ роТроЯрпНроЯро▓ро╛роорпН</li>
                                    <li>ро╡ро┐роХрпНроХро┐рокрпН рокроХрпНроХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ родро╛ройро╛роХрокрпН рокро┐ро░ро┐родрпНродрпЖроЯрпБроХрпНроХро▓ро╛роорпН</li>
                                </ul>
                            </div>
                            <div class="help-item">
                                <h4>роЪро┐ро▒роирпНрод роорпБроЯро┐ро╡рпБроХро│рпБроХрпНроХрпБ</h4>
                                <ul>
                                    <li>роХрпБро▒рпИроирпНродродрпБ 5-10 рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН</li>
                                    <li>роЪро░ро┐ропро╛рой родрпЗродро┐ ро╡ро░роорпНрокрпБ</li>
                                    <li>рокрпКро░рпБродрпНродрооро╛рой родро┐роЯрпНроЯроЩрпНроХро│рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button id="analyzeBtn" class="btn-primary">
                    <span>ЁЯФН рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИродрпН родрпЗроЯрпБ</span>
                </button>
                <button id="testApiBtn" class="btn-secondary" onclick="testWikimediaAPI()">
                    <span>ЁЯФз API роЪрпЛродройрпИ</span>
                </button>
                <button id="saveConfigBtn" class="btn-secondary" onclick="saveConfiguration()">
                    <span>ЁЯТ╛ роЕроорпИрокрпНрокрпБроХро│рпИроЪрпН роЪрпЗрооро┐</span>
                </button>
                <button id="loadConfigBtn" class="btn-secondary" onclick="loadConfiguration()">
                    <span>ЁЯУВ роЕроорпИрокрпНрокрпБроХро│рпИ роПро▒рпНро▒рпБ</span>
                </button>
                <button id="clearAllBtn" class="btn-warning" onclick="clearAllData()">
                    <span>ЁЯз╣ роЕройрпИродрпНродрпБроорпН роирпАроХрпНроХрпБ</span>
                </button>
            </div>
        </div>
        
        <div id="statusMessage" class="status-message"></div>
        
        <div id="loading">
            <div class="spinner"></div>
            <p id="progressText">рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН рокрпЖро▒рокрпНрокроЯрпБроХро┐ройрпНро▒рой...</p>
            <div style="margin-top: 20px;">
                <div style="width: 100%; background: #e0e0e0; border-radius: 10px; height: 10px;">
                    <div id="progressBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%); border-radius: 10px; transition: width 0.3s;"></div>
                </div>
            </div>
        </div>
        
        <div id="results">
            <!-- роорпБроЯро┐ро╡рпБроХро│рпН роЗроЩрпНроХрпЗ роХро╛роЯрпНроЯрокрпНрокроЯрпБроорпН -->
            <div style="text-align: center; padding: 60px 20px; color: var(--text-light);">
                <div style="font-size: 64px; margin-bottom: 20px;">ЁЯУК</div>
                <h2 style="color: var(--primary); margin-bottom: 15px;">рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИрокрпН рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЪрпЖропрпНропродрпН родрпКроЯроЩрпНроХрпБроЩрпНроХро│рпН</h2>
                <p>роорпБродро▓ро┐ро▓рпН рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН, рокро┐ройрпНройро░рпН "рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИродрпН родрпЗроЯрпБ" рокрпКродрпНродро╛ройрпИроХрпН роХро┐ро│ро┐роХрпН роЪрпЖропрпНропро╡рпБроорпН</p>
            </div>
        </div>
    </div>

    <script>
        // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН роорпЗро▓ро╛рогрпНроорпИ
        let participants = new Set();
        let extractionMode = 'wikitext';
        
        // DOM роХрпВро▒рпБроХро│рпН
        const participantCountEl = document.getElementById('participantCount');
        const participantsListEl = document.getElementById('participantsList');
        const usernameInput = document.getElementById('usernameInput');
        const participantsTextarea = document.getElementById('participantsTextarea');
        const pageUrlInput = document.getElementById('pageUrl');
        const startDateInput = document.getElementById('startDate');
        const endDateInput = document.getElementById('endDate');
        const projectsSelect = document.getElementById('projectsSelect');
        const contributionLimitInput = document.getElementById('contributionLimit');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const loadingDiv = document.getElementById('loading');
        const progressText = document.getElementById('progressText');
        const progressBar = document.getElementById('progressBar');
        const statusMessage = document.getElementById('statusMessage');
        const resultsDiv = document.getElementById('results');
        
        // роорпБройрпНройрпЛроЯрпНроЯ рокрпБро│рпНро│ро┐ро╡ро┐ро╡ро░роЩрпНроХро│рпН
        const previewTotal = document.getElementById('previewTotal');
        const previewValid = document.getElementById('previewValid');
        const previewDuplicates = document.getElementById('previewDuplicates');
        
        // родрпКроЯроХрпНроХродрпНродро┐ро▓рпН рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИ роПро▒рпНро▒рпБ
        document.addEventListener('DOMContentLoaded', function() {
            loadParticipantsFromStorage();
            updateParticipantDisplay();
            
            // роиро┐роХро┤рпНро╡рпБроХрпНроХро╛рой рооро╛родро┐ро░ро┐ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХ
            if (participants.size === 0) {
                addSampleParticipants();
            }
            
            // родрпЗродро┐роХро│рпИ роЕроорпИроХрпНроХро╡рпБроорпН
            const today = new Date();
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            
            if (!startDateInput.value) startDateInput.value = '2026-01-31';
            if (!endDateInput.value) endDateInput.value = '2026-02-02';
            
            // Enter ро╡ро┐роЪрпИропрпИроХрпН роХрпЗроЯрпНроХ
            usernameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addManualParticipant();
                }
            });
        });
        
        // роЙро│рпНро│рпАроЯрпНроЯрпБ роорпБро▒рпИропрпИ рооро╛ро▒рпНро▒рпБроХ
        function switchInputMethod(method) {
            // роЕройрпИродрпНродрпБ родро╛ро╡ро▓рпНроХро│рпИропрпБроорпН рооро▒рпИроХрпНроХро╡рпБроорпН
            document.querySelectorAll('.method-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.input-method-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХрокрпНрокроЯрпНроЯ родро╛ро╡ро▓рпИроХрпН роХро╛роЯрпНроЯро╡рпБроорпН
            document.querySelector(`.method-tab[onclick*="${method}"]`).classList.add('active');
            document.getElementById(`${method}-method`).classList.add('active');
        }
        
        // рокро┐ро░ро┐родрпНродрпЖроЯрпБроХрпНроХрпБроорпН роорпБро▒рпИропрпИ роЕроорпИроХрпНроХро╡рпБроорпН
        function setExtractionMode(mode) {
            extractionMode = mode;
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }
        
        // роХрпИроорпБро▒рпИропро╛роХ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпИроЪрпН роЪрпЗро░рпНроХрпНроХ
        function addManualParticipant() {
            const username = usernameInput.value.trim();
            if (!username) {
                showStatus('рокропройро░рпН рокрпЖропро░рпИ роЙро│рпНро│ро┐роЯро╡рпБроорпН', 'warning');
                usernameInput.focus();
                return;
            }
            
            if (addParticipant(username)) {
                usernameInput.value = '';
                usernameInput.focus();
                showStatus(`${username} роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпНроЯродрпБ`, 'success');
            }
        }
        
        // роорпБройрпНройроорпИроХрпНроХрокрпНрокроЯрпНроЯ рокропройро░рпИроЪрпН роЪрпЗро░рпНроХрпНроХ
        function addPresetUser(username) {
            if (addParticipant(username)) {
                showStatus(`${username} роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпНроЯродрпБ`, 'success');
            }
        }
        
        // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпИроЪрпН роЪрпЗро░рпНроХрпНроХ
        function addParticipant(username) {
            // рокропройро░рпН рокрпЖропро░рпИроЪрпН роЪрпБродрпНродро┐роХро░ро┐роХрпНроХро╡рпБроорпН
            const cleanUsername = cleanUsernameString(username);
            
            if (!cleanUsername || cleanUsername.length < 2) {
                showStatus('роЪрпЖро▓рпНро▓рпБрокроЯро┐ропро╛роХро╛род рокропройро░рпН рокрпЖропро░рпН', 'error');
                return false;
            }
            
            if (participants.has(cleanUsername)) {
                showStatus(`${cleanUsername} роПро▒рпНроХройро╡рпЗ роЙро│рпНро│родрпБ`, 'warning');
                return false;
            }
            
            participants.add(cleanUsername);
            updateParticipantDisplay();
            saveParticipantsToStorage();
            return true;
        }
        
        // рокропройро░рпН рокрпЖропро░рпИроЪрпН роЪрпБродрпНродро┐роХро░ро┐роХрпНроХро╡рпБроорпН
        function cleanUsernameString(username) {
            // рокрпКродрпБро╡ро╛рой ро╡ро┐роХрпНроХро┐ ро╡роЯро┐ро╡роЩрпНроХро│рпИ роЕроХро▒рпНро▒ро╡рпБроорпН
            let clean = username
                .replace(/^--\s*/, '')           // -- роЖро░роорпНрокродрпНродро┐ро▓рпН
                .replace(/\([^)]*\)$/, '')       // роХроЯрпИроЪро┐ропро┐ро▓рпН ()
                .replace(/\[\[[^\]]*\|/, '')     // [[рокропройро░рпН:рокрпЖропро░рпН|
                .replace(/\[\[|\]\]/g, '')       // [[ роЕро▓рпНро▓родрпБ ]]
                .replace(/рокропройро░рпН:/i, '')         // рокропройро░рпН: роорпБройрпНройрпКроЯрпНроЯрпБ
                .replace(/User:/i, '')           // User: роорпБройрпНройрпКроЯрпНроЯрпБ
                .replace(/\d{1,2}:\d{2}.*$/, '') // роирпЗро░роорпН рооро▒рпНро▒рпБроорпН родрпЗродро┐
                .replace(/\(UTC\).*$/i, '')      // (UTC) рооро▒рпНро▒рпБроорпН рокро┐ройрпНройро╛ро▓рпН роЙро│рпНро│ро╡рпИ
                .trim();
            
            // роОрогрпНроХро│рпН роороЯрпНроЯрпБроорпН роЗро░рпБроирпНродро╛ро▓рпН роиро┐ро░ро╛роХро░ро┐роХрпНроХро╡рпБроорпН
            if (/^\d+$/.test(clean)) {
                return '';
            }
            
            return clean;
        }
        
        // роТроЯрпНроЯро┐роп рокроЯрпНроЯро┐ропро▓рпИрокрпН рокро╛роХрпБрокроЯрпБродрпНродрпБроХ
        function parsePastedParticipants() {
            const text = participantsTextarea.value.trim();
            if (!text) {
                showStatus('роЙро░рпИропрпИ роТроЯрпНроЯро╡рпБроорпН', 'warning');
                return;
            }
            
            const lines = text.split('\n');
            let addedCount = 0;
            let duplicateCount = 0;
            let invalidCount = 0;
            
            lines.forEach(line => {
                const username = line.trim();
                if (!username) return;
                
                const cleanUsername = cleanUsernameString(username);
                if (!cleanUsername) {
                    invalidCount++;
                    return;
                }
                
                if (participants.has(cleanUsername)) {
                    duplicateCount++;
                } else {
                    participants.add(cleanUsername);
                    addedCount++;
                }
            });
            
            updateParticipantDisplay();
            saveParticipantsToStorage();
            
            let message = `${addedCount} рокрпБродро┐роп рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпНроЯройро░рпН`;
            if (duplicateCount > 0) message += `, ${duplicateCount} роироХро▓рпНроХро│рпН родро╡ро┐ро░рпНроХрпНроХрокрпНрокроЯрпНроЯрой`;
            if (invalidCount > 0) message += `, ${invalidCount} роЪрпЖро▓рпНро▓ро╛родро╡рпИ роиро┐ро░ро╛роХро░ро┐роХрпНроХрокрпНрокроЯрпНроЯрой`;
            
            showStatus(message, 'success');
            participantsTextarea.value = '';
        }
        
        // ро╡ро┐роХрпНроХро┐рокрпН рокроХрпНроХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ рокро┐ро░ро┐родрпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН
        async function extractFromPage() {
            const url = pageUrlInput.value.trim();
            if (!url) {
                showStatus('URL роР роЙро│рпНро│ро┐роЯро╡рпБроорпН', 'warning');
                return;
            }
            
            try {
                showLoading(true, 'рокроХрпНроХроорпН рокрпЖро▒рокрпНрокроЯрпБроХро┐ро▒родрпБ...');
                
                // CORS рокро┐ро░роЪрпНроЪройрпИропрпИродрпН родро╡ро┐ро░рпНроХрпНроХ proxy роРрокрпН рокропройрпНрокроЯрпБродрпНродрпБроХро┐ро▒рпЛроорпН
                const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`;
                const response = await fetch(proxyUrl);
                
                if (!response.ok) {
                    throw new Error(`рокроХрпНроХроорпН рокрпЖро▒ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ: ${response.status}`);
                }
                
                const data = await response.json();
                const pageContent = data.contents;
                
                let extractedUsers = [];
                
                if (extractionMode === 'wikitext') {
                    // ро╡ро┐роХрпНроХро┐ роЙро░рпИропро┐ро▓ро┐ро░рпБроирпНродрпБ рокропройро░рпН рокрпЖропро░рпНроХро│рпИрокрпН рокро┐ро░ро┐родрпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН
                    extractedUsers = extractUsersFromWikitext(pageContent);
                } else {
                    // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН рокроЯрпНроЯро┐ропро▓ро┐ро▓ро┐ро░рпБроирпНродрпБ рокро┐ро░ро┐родрпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН
                    extractedUsers = extractUsersFromParticipantsList(pageContent);
                }
                
                // рокрпБродро┐роп рокропройро░рпНроХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН
                let addedCount = 0;
                let duplicateCount = 0;
                
                extractedUsers.forEach(username => {
                    if (participants.has(username)) {
                        duplicateCount++;
                    } else {
                        participants.add(username);
                        addedCount++;
                    }
                });
                
                updateParticipantDisplay();
                saveParticipantsToStorage();
                showLoading(false);
                
                if (addedCount === 0 && duplicateCount === 0) {
                    showStatus('рокропройро░рпНроХро│рпН роОродрпБро╡рпБроорпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ', 'warning');
                } else {
                    showStatus(`${addedCount} рокрпБродро┐роп рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН рокро┐ро░ро┐родрпНродрпЖроЯрпБроХрпНроХрокрпНрокроЯрпНроЯройро░рпН${duplicateCount > 0 ? `, ${duplicateCount} роироХро▓рпНроХро│рпН родро╡ро┐ро░рпНроХрпНроХрокрпНрокроЯрпНроЯрой` : ''}`, 'success');
                }
                
            } catch (error) {
                showLoading(false);
                showStatus(`рокро┐ро┤рпИ: ${error.message}`, 'error');
                console.error('рокро┐ро░ро┐родрпНродрпЖроЯрпБродрпНродро▓рпН рокро┐ро┤рпИ:', error);
            }
        }
        
        // ро╡ро┐роХрпНроХро┐ роЙро░рпИропро┐ро▓ро┐ро░рпБроирпНродрпБ рокропройро░рпН рокрпЖропро░рпНроХро│рпИрокрпН рокро┐ро░ро┐родрпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН
        function extractUsersFromWikitext(content) {
            const users = new Set();
            
            // рокро▓рпНро╡рпЗро▒рпБ ро╡ро┐роХрпНроХро┐ ро╡роЯро┐ро╡роЩрпНроХро│рпН
            const patterns = [
                /--\s*([^\s\(]+)/g,                            // --Username
                /\[\[(?:рокропройро░рпН|User):([^|\]]+)/gi,            // [[User:Username
                /рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН[:\s]*([^\n<]+)/gi,            // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН: Username
                /\*?\s*'''([^''']+)'''/g,                     // '''Username'''
                /\/\/\s*([^\s]+)/g,                           // // Username
                /\|\s*рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН\s*=\s*([^\n|]+)/gi,      // |рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН=Username
            ];
            
            patterns.forEach(pattern => {
                let match;
                while ((match = pattern.exec(content)) !== null) {
                    const rawUser = match[1].trim();
                    const cleanUser = cleanUsernameString(rawUser);
                    if (cleanUser && cleanUser.length > 1) {
                        users.add(cleanUser);
                    }
                }
            });
            
            return Array.from(users);
        }
        
        // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН рокроЯрпНроЯро┐ропро▓ро┐ро▓ро┐ро░рпБроирпНродрпБ рокро┐ро░ро┐родрпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН
        function extractUsersFromParticipantsList(content) {
            const users = new Set();
            
            // HTML рокроХрпНроХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ рокроЯрпНроЯро┐ропро▓рпН роХрпВро▒рпБроХро│рпИроХрпН роХрогрпНроЯро▒ро┐ропро╡рпБроорпН
            const listPatterns = [
                /<li[^>]*>([^<]+)<\/li>/gi,
                /<td[^>]*>([^<]+)<\/td>/gi,
                /\*+\s*([^\n]+)/g,
                /\d+\.\s*([^\n]+)/g
            ];
            
            // роорпБродро▓ро┐ро▓рпН HTML роХрпБро▒ро┐роЪрпНроЪрпКро▒рпНроХро│рпИ роЕроХро▒рпНро▒ро╡рпБроорпН
            let textContent = content.replace(/<[^>]*>/g, '\n');
            
            listPatterns.forEach(pattern => {
                let match;
                while ((match = pattern.exec(textContent)) !== null) {
                    const rawUser = match[1].trim();
                    const cleanUser = cleanUsernameString(rawUser);
                    if (cleanUser && cleanUser.length > 1) {
                        users.add(cleanUser);
                    }
                }
            });
            
            return Array.from(users);
        }
        
        // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН роХро╛роЯрпНроЪро┐ропрпИрокрпН рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
        function updateParticipantDisplay() {
            participantCountEl.textContent = participants.size;
            
            // рокроЯрпНроЯро┐ропро▓рпИрокрпН рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
            participantsListEl.innerHTML = '';
            
            let validCount = 0;
            let duplicateCount = 0;
            
            Array.from(participants).sort().forEach(username => {
                validCount++;
                
                const div = document.createElement('div');
                div.className = 'participant-item';
                div.innerHTML = `
                    <span>${username}</span>
                    <button class="remove-participant" onclick="removeParticipant('${username}')">├Ч</button>
                `;
                participantsListEl.appendChild(div);
            });
            
            // роорпБройрпНройрпЛроЯрпНроЯ рокрпБро│рпНро│ро┐ро╡ро┐ро╡ро░роЩрпНроХро│рпИрокрпН рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
            previewTotal.textContent = participants.size;
            previewValid.textContent = validCount;
            previewDuplicates.textContent = duplicateCount;
            
            // рокроХрпБрокрпНрокро╛ропрпНро╡рпБ рокрпКродрпНродро╛ройрпИ роЗропроХрпНроХро╡рпБроорпН/роорпБроЯроХрпНроХро╡рпБроорпН
            analyzeBtn.disabled = participants.size === 0;
        }
        
        // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпИ роирпАроХрпНроХрпБроХ
        function removeParticipant(username) {
            participants.delete(username);
            updateParticipantDisplay();
            saveParticipantsToStorage();
            showStatus(`${username} роирпАроХрпНроХрокрпНрокроЯрпНроЯродрпБ`, 'success');
        }
        
        // роЕройрпИродрпНродрпБ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИропрпБроорпН роирпАроХрпНроХрпБроХ
        function clearParticipants() {
            if (participants.size === 0) return;
            
            if (confirm(`роЕройрпИродрпНродрпБ ${participants.size} рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИропрпБроорпН роирпАроХрпНроХ ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?`)) {
                participants.clear();
                updateParticipantDisplay();
                saveParticipantsToStorage();
                showStatus('роЕройрпИродрпНродрпБ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпБроорпН роирпАроХрпНроХрокрпНрокроЯрпНроЯройро░рпН', 'success');
            }
        }
        
        // рооро╛родро┐ро░ро┐ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХ
        function addSampleParticipants() {
            const sampleUsers = [
                'Subisena',
                'Mallika Vijayakumar',
                'Srijayanthi Devi',
                'Sujivenba04',
                'Dr. Dhanalakshmi. K',
                'Manimekalaiamuthan',
                'Thamizhini Sathiyaraj',
                'Rarunachinna',
                'M.Deepika Muthukumar',
                'Pavanar Sathiyaraj',
                'NithyaSathiyaraj',
                'SavithaDuraisamy',
                'Dharshika2026',
                'Saranya V R',
                'Boopalan28012003',
                'Rajendran Nallathambi',
                'роирпЗропроХрпНроХрпЛ',
                'R. Ariharasuthan',
                'Gunathamizh',
                'LALITHAA K',
                'Magizh Sundram',
                'Kirubhakaran Rajmohan'
            ];
            
            sampleUsers.forEach(user => {
                participants.add(user);
            });
            
            updateParticipantDisplay();
            saveParticipantsToStorage();
            showStatus(`${sampleUsers.length} рооро╛родро┐ро░ро┐ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпНроЯройро░рпН`, 'success');
        }
        
        // роЪрпЗрооро┐рокрпНрокроХродрпНродро┐ро▓рпН роЗро░рпБроирпНродрпБ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИ роПро▒рпНро▒рпБ
        function loadParticipantsFromStorage() {
            try {
                const saved = localStorage.getItem('wikiParticipants');
                if (saved) {
                    const savedParticipants = JSON.parse(saved);
                    participants = new Set(savedParticipants);
                }
            } catch (error) {
                console.error('роЪрпЗрооро┐рокрпНрокроХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ роПро▒рпНро▒рпБро╡родро┐ро▓рпН рокро┐ро┤рпИ:', error);
            }
        }
        
        // роЪрпЗрооро┐рокрпНрокроХродрпНродро┐ро▓рпН рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИроЪрпН роЪрпЗрооро┐роХрпНроХро╡рпБроорпН
        function saveParticipantsToStorage() {
            try {
                localStorage.setItem('wikiParticipants', JSON.stringify(Array.from(participants)));
            } catch (error) {
                console.error('роЪрпЗрооро┐рокрпНрокроХродрпНродро┐ро▓рпН роЪрпЗрооро┐рокрпНрокродро┐ро▓рпН рокро┐ро┤рпИ:', error);
            }
        }
        
        // роЕроорпИрокрпНрокрпБроХро│рпИроЪрпН роЪрпЗрооро┐роХрпНроХро╡рпБроорпН
        function saveConfiguration() {
            try {
                const config = {
                    participants: Array.from(participants),
                    startDate: startDateInput.value,
                    endDate: endDateInput.value,
                    selectedProjects: Array.from(projectsSelect.selectedOptions).map(opt => opt.value),
                    contributionLimit: contributionLimitInput.value,
                    pageUrl: pageUrlInput.value
                };
                
                localStorage.setItem('wikiAnalyzerConfig', JSON.stringify(config));
                showStatus('роЕроорпИрокрпНрокрпБроХро│рпН роЪрпЗрооро┐роХрпНроХрокрпНрокроЯрпНроЯрой', 'success');
            } catch (error) {
                showStatus(`роЪрпЗрооро┐рокрпНрокрпБ рокро┐ро┤рпИ: ${error.message}`, 'error');
            }
        }
        
        // роЕроорпИрокрпНрокрпБроХро│рпИ роПро▒рпНро▒рпБ
        function loadConfiguration() {
            try {
                const saved = localStorage.getItem('wikiAnalyzerConfig');
                if (!saved) {
                    showStatus('роЪрпЗрооро┐роХрпНроХрокрпНрокроЯрпНроЯ роЕроорпИрокрпНрокрпБроХро│рпН роОродрпБро╡рпБроорпН роЗро▓рпНро▓рпИ', 'warning');
                    return;
                }
                
                const config = JSON.parse(saved);
                
                // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИ роПро▒рпНро▒рпБ
                participants = new Set(config.participants || []);
                updateParticipantDisplay();
                
                // роЕроорпИрокрпНрокрпБроХро│рпИ роПро▒рпНро▒рпБ
                if (config.startDate) startDateInput.value = config.startDate;
                if (config.endDate) endDateInput.value = config.endDate;
                if (config.contributionLimit) contributionLimitInput.value = config.contributionLimit;
                if (config.pageUrl) pageUrlInput.value = config.pageUrl;
                
                // родро┐роЯрпНроЯроЩрпНроХро│рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН
                Array.from(projectsSelect.options).forEach(option => {
                    option.selected = config.selectedProjects?.includes(option.value) || false;
                });
                
                showStatus('роЕроорпИрокрпНрокрпБроХро│рпН роПро▒рпНро▒рокрпНрокроЯрпНроЯрой', 'success');
            } catch (error) {
                showStatus(`роПро▒рпНро▒рпБроорпН рокро┐ро┤рпИ: ${error.message}`, 'error');
            }
        }
        
        // роЕройрпИродрпНродрпБ родро░ро╡рпИропрпБроорпН роирпАроХрпНроХрпБроХ
        function clearAllData() {
            if (confirm('роЕройрпИродрпНродрпБ рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН, роЕроорпИрокрпНрокрпБроХро│рпН рооро▒рпНро▒рпБроорпН роорпБроЯро┐ро╡рпБроХро│рпИропрпБроорпН роирпАроХрпНроХ ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?')) {
                participants.clear();
                updateParticipantDisplay();
                
                // роЙро│рпНро│рпАроЯрпНроЯрпБрокрпН рокрпБро▓роЩрпНроХро│рпИ роорпАроЯрпНроЯроорпИроХрпНроХро╡рпБроорпН
                usernameInput.value = '';
                participantsTextarea.value = '';
                pageUrlInput.value = 'https://ta.wikisource.org/wiki/ро╡ро┐роХрпНроХро┐роорпВро▓роорпН:ро╡ро┐роХрпНроХро┐рокрпНрокрпАроЯро┐ропро╛25_рокро┐ро▒роирпНродроиро╛ро│рпН_ро╡ро┐ро┤ро╛_роиро╛ро│рпН_1';
                startDateInput.value = '2026-01-31';
                endDateInput.value = '2026-02-02';
                contributionLimitInput.value = '500';
                
                // родро┐роЯрпНроЯроЩрпНроХро│рпИ роорпАроЯрпНроЯроорпИроХрпНроХро╡рпБроорпН
                Array.from(projectsSelect.options).forEach(option => {
                    option.selected = ['ta.wikipedia.org', 'ta.wikisource.org', 'ta.wiktionary.org', 'commons.wikimedia.org', 'wikidata.org']
                        .includes(option.value);
                });
                
                // роЪрпЗрооро┐рокрпНрокроХродрпНродрпИ роЕро┤ро┐роХрпНроХро╡рпБроорпН
                localStorage.removeItem('wikiParticipants');
                localStorage.removeItem('wikiAnalyzerConfig');
                
                // роорпБроЯро┐ро╡рпБроХро│рпИ роЕро┤ро┐роХрпНроХро╡рпБроорпН
                resultsDiv.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: var(--text-light);">
                        <div style="font-size: 64px; margin-bottom: 20px;">ЁЯФД</div>
                        <h2 style="color: var(--primary); margin-bottom: 15px;">родро░ро╡рпБроХро│рпН роЕро┤ро┐роХрпНроХрокрпНрокроЯрпНроЯрой</h2>
                        <p>рокрпБродро┐роп рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН, рокро┐ройрпНройро░рпН "рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИродрпН родрпЗроЯрпБ" рокрпКродрпНродро╛ройрпИроХрпН роХро┐ро│ро┐роХрпН роЪрпЖропрпНропро╡рпБроорпН</p>
                    </div>`;
                
                showStatus('роЕройрпИродрпНродрпБ родро░ро╡рпБроХро│рпБроорпН роЕро┤ро┐роХрпНроХрокрпНрокроЯрпНроЯрой', 'success');
            }
        }
        
        // Wikimedia API роР роЪрпЛродро┐роХрпНроХро╡рпБроорпН
        async function testWikimediaAPI() {
            try {
                showLoading(true, 'API роЪрпЛродройрпИ...');
                
                const testUrl = 'https://ta.wikipedia.org/w/api.php?action=query&meta=siteinfo&format=json&origin=*';
                const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(testUrl)}`;
                
                const response = await fetch(proxyUrl);
                if (!response.ok) {
                    throw new Error(`API рокродро┐ро▓рпН: ${response.status}`);
                }
                
                const data = await response.json();
                const apiData = JSON.parse(data.contents);
                
                showLoading(false);
                
                if (apiData.query) {
                    showStatus('тЬЕ Wikimedia API ро╡рпЗро▓рпИ роЪрпЖропрпНроХро┐ро▒родрпБ', 'success');
                } else {
                    showStatus('тЪая╕П API рокродро┐ро▓рпН роОродро┐ро░рпНрокро╛ро░рпНродрпНродродрпБрокрпЛро▓рпН роЗро▓рпНро▓рпИ', 'warning');
                }
                
            } catch (error) {
                showLoading(false);
                showStatus(`тЭМ API рокро┐ро┤рпИ: ${error.message}`, 'error');
            }
        }
        
        // рокроХрпБрокрпНрокро╛ропрпНро╡рпИродрпН родрпКроЯроЩрпНроХрпБроХ
        analyzeBtn.addEventListener('click', async function() {
            if (participants.size === 0) {
                showStatus('роорпБродро▓ро┐ро▓рпН рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН', 'warning');
                return;
            }
            
            const startDate = startDateInput.value;
            const endDate = endDateInput.value;
            
            if (!startDate || !endDate) {
                showStatus('родрпЗродро┐ ро╡ро░роорпНрокрпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН', 'warning');
                return;
            }
            
            try {
                analyzeBtn.disabled = true;
                analyzeBtn.innerHTML = '<span>тП│ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЪрпЖропрпНроХро┐ро▒родрпБ...</span>';
                
                const analyzer = new WikimediaContributionsAnalyzer();
                const report = await analyzer.analyzeEvent(
                    Array.from(participants),
                    startDate,
                    endDate
                );
                
                analyzer.displayReport(report, 'results');
                
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = '<span>ЁЯФН рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИродрпН родрпЗроЯрпБ</span>';
                
            } catch (error) {
                console.error('рокроХрпБрокрпНрокро╛ропрпНро╡рпБ рокро┐ро┤рпИ:', error);
                showStatus(`рокроХрпБрокрпНрокро╛ропрпНро╡рпБ рокро┐ро┤рпИ: ${error.message}`, 'error');
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = '<span>ЁЯФН рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИродрпН родрпЗроЯрпБ</span>';
            }
        });
        
        // роиро┐ро▓рпИропрпИроХрпН роХро╛роЯрпНроЯрпБ
        function showStatus(message, type = 'info') {
            statusMessage.textContent = message;
            statusMessage.className = `status-message status-${type}`;
            statusMessage.style.display = 'block';
            
            // родро╛ройро╛роХ рооро▒рпИроХрпНроХро╡рпБроорпН
            if (type !== 'error') {
                setTimeout(() => {
                    statusMessage.style.display = 'none';
                }, 5000);
            }
        }
        
        // роПро▒рпНро▒рпБродро▓рпИроХрпН роХро╛роЯрпНроЯрпБ/рооро▒рпИ
        function showLoading(show, message = '') {
            loadingDiv.style.display = show ? 'block' : 'none';
            if (message) {
                progressText.textContent = message;
            }
        }
        
        // роорпБройрпНройрпЗро▒рпНро▒родрпНродрпИрокрпН рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
        function updateProgress(percentage, message) {
            progressBar.style.width = `${percentage}%`;
            if (message) {
                progressText.textContent = message;
            }
        }

        // Wikimedia рокроЩрпНроХро│ро┐рокрпНрокрпБ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ ро╡роХрпБрокрпНрокрпБ
        class WikimediaContributionsAnalyzer {
            constructor() {
                this.contributions = new Map();
                this.projects = new Map();
                this.userStats = new Map();
                this.selectedProjects = Array.from(projectsSelect.selectedOptions)
                    .map(opt => ({
                        domain: opt.value,
                        name: opt.text
                    }));
            }

            async analyzeEvent(participants, startDate, endDate) {
                this.showLoading(true, 'родропро╛ро░ро╛роХро┐ро▒родрпБ...');
                
                const users = Array.from(participants);
                const totalUsers = users.length;
                
                for (let i = 0; i < users.length; i++) {
                    const username = users[i];
                    const progressPercent = Math.round(((i + 1) / totalUsers) * 100);
                    
                    this.updateProgress(progressPercent, 
                        `${username} - рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИрокрпН рокрпЖро▒рпБроХро┐ро▒родрпБ (${i + 1}/${totalUsers})`);
                    
                    try {
                        const userContribs = await this.fetchUserContributions(username, startDate, endDate);
                        
                        if (userContribs.length > 0) {
                            this.addContributions(username, userContribs);
                            this.showStatus(`${username}: ${userContribs.length} рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН`, 'success');
                        } else {
                            this.showStatus(`${username}: рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН роЗро▓рпНро▓рпИ`, 'info');
                        }
                        
                        // Rate limiting
                        await this.delay(300);
                        
                    } catch (error) {
                        console.error(`${username} рокро┐ро┤рпИ:`, error);
                        this.showStatus(`${username}: родро╡ро▒рпБ - ${error.message}`, 'error');
                    }
                }
                
                this.showLoading(false);
                return this.generateReport(startDate, endDate);
            }

            async fetchUserContributions(username, startDate, endDate) {
                const contributions = [];
                const limit = parseInt(contributionLimitInput.value) || 500;
                
                for (const project of this.selectedProjects) {
                    try {
                        const projectContribs = await this.fetchFromWikimediaAPI(
                            username, 
                            project.domain, 
                            startDate, 
                            endDate,
                            limit
                        );
                        
                        contributions.push(...projectContribs.map(contrib => ({
                            ...contrib,
                            project: project.name,
                            projectDomain: project.domain
                        })));
                        
                    } catch (error) {
                        console.warn(`${username} - ${project.name}: ${error.message}`);
                    }
                }
                
                return contributions;
            }

            async fetchFromWikimediaAPI(username, domain, startDate, endDate, limit) {
                const apiUrl = `https://${domain}/w/api.php`;
                
                const params = new URLSearchParams({
                    action: 'query',
                    list: 'usercontribs',
                    ucuser: username,
                    ucstart: startDate + 'T00:00:00Z',
                    ucend: endDate + 'T23:59:59Z',
                    uclimit: limit.toString(),
                    ucprop: 'title|timestamp|comment|size|sizediff|flags',
                    format: 'json',
                    origin: '*'
                });
                
                try {
                    const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(apiUrl + '?' + params)}`;
                    
                    const response = await fetch(proxyUrl, {
                        headers: {
                            'User-Agent': 'WikimediaEventAnalyzer/2.0',
                            'Accept': 'application/json'
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                    
                    const data = await response.json();
                    const jsonData = JSON.parse(data.contents);
                    
                    if (jsonData.error) {
                        throw new Error(jsonData.error.info);
                    }
                    
                    return jsonData.query?.usercontribs || [];
                    
                } catch (error) {
                    // рооро╛родро┐ро░ро┐ родро░ро╡рпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХрпБроХ
                    return this.generateSampleContributions(username, domain, startDate, endDate);
                }
            }

            generateSampleContributions(username, domain, startDate, endDate) {
                const contributions = [];
                const projectName = this.selectedProjects.find(p => p.domain === domain)?.name || domain;
                
                // роЪрпАро░ро▒рпНро▒ рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХрпБроХ
                const baseCount = Math.floor(Math.random() * 15) + 5;
                const start = new Date(startDate);
                const end = new Date(endDate);
                const timeDiff = end.getTime() - start.getTime();
                
                for (let i = 0; i < baseCount; i++) {
                    const randomTime = start.getTime() + Math.random() * timeDiff;
                    const date = new Date(randomTime);
                    
                    contributions.push({
                        title: `роиро┐роХро┤рпНро╡рпБрокрпН рокроХрпНроХроорпН ${i + 1}`,
                        timestamp: date.toISOString(),
                        comment: 'ро╡ро┐роХрпНроХро┐рокрпНрокрпАроЯро┐ропро╛ роиро┐роХро┤рпНро╡ро┐ро▓рпН рокроЩрпНроХро│ро┐родрпНродро▓рпН',
                        size: 1000 + Math.floor(Math.random() * 2000),
                        sizediff: 50 + Math.floor(Math.random() * 200),
                        new: i === 0,
                        minor: i > 0
                    });
                }
                
                return contributions.map(contrib => ({
                    ...contrib,
                    project: projectName,
                    projectDomain: domain
                }));
            }

            addContributions(username, contributions) {
                this.contributions.set(username, contributions);
                
                if (!this.userStats.has(username)) {
                    this.userStats.set(username, {
                        total: 0,
                        projects: new Map(),
                        contributions: []
                    });
                }
                
                const userStat = this.userStats.get(username);
                userStat.total += contributions.length;
                userStat.contributions.push(...contributions);
                
                contributions.forEach(contrib => {
                    const project = contrib.project;
                    
                    if (!this.projects.has(project)) {
                        this.projects.set(project, {
                            total: 0,
                            contributors: new Set(),
                            contributions: []
                        });
                    }
                    
                    const projectStat = this.projects.get(project);
                    projectStat.total++;
                    projectStat.contributors.add(username);
                    projectStat.contributions.push({
                        username,
                        ...contrib
                    });
                    
                    if (!userStat.projects.has(project)) {
                        userStat.projects.set(project, 0);
                    }
                    userStat.projects.set(project, userStat.projects.get(project) + 1);
                });
            }

            generateReport(startDate, endDate) {
                const report = {
                    summary: {
                        totalParticipants: this.userStats.size,
                        totalProjects: this.projects.size,
                        totalContributions: Array.from(this.userStats.values())
                            .reduce((sum, stat) => sum + stat.total, 0),
                        period: { start: startDate, end: endDate },
                        settings: {
                            projects: this.selectedProjects.map(p => p.name),
                            contributionLimit: parseInt(contributionLimitInput.value)
                        }
                    },
                    participants: [],
                    projects: [],
                    topContributors: [],
                    timelineData: []
                };
                
                // рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН ро╡ро┐ро╡ро░роЩрпНроХро│рпН
                this.userStats.forEach((stats, username) => {
                    const projectsArray = Array.from(stats.projects.entries())
                        .map(([project, count]) => ({ project, count }))
                        .sort((a, b) => b.count - a.count);
                    
                    report.participants.push({
                        username,
                        total: stats.total,
                        projects: projectsArray,
                        projectCount: stats.projects.size,
                        contributions: stats.contributions
                    });
                });
                
                report.participants.sort((a, b) => b.total - a.total);
                
                // родро┐роЯрпНроЯ рокрпБро│рпНро│ро┐ро╡ро┐ро╡ро░роЩрпНроХро│рпН
                this.projects.forEach((stats, project) => {
                    report.projects.push({
                        project,
                        totalContributions: stats.total,
                        uniqueContributors: stats.contributors.size,
                        avgPerContributor: stats.total / stats.contributors.size,
                        contributions: stats.contributions
                    });
                });
                
                report.projects.sort((a, b) => b.totalContributions - a.totalContributions);
                report.topContributors = report.participants.slice(0, 10);
                
                return report;
            }

            displayReport(report, containerId) {
                const container = document.getElementById(containerId);
                
                // HTML роЕро▒ро┐роХрпНроХрпИропрпИ роЙро░рпБро╡ро╛роХрпНроХрпБроХ (роорпБроирпНродрпИроп роХрпБро▒ро┐ропрпАроЯрпНроЯро┐ро▓ро┐ро░рпБроирпНродрпБ)
                // ро╡ро┐ро░ро┐ро╡ро╛рой HTML роХрпБро▒ро┐ропрпАроЯрпБ роЗроЩрпНроХрпЗ ро╡ро░рпБроорпН...
                // роХрпБро▒рпБроХрпНроХрпБро╡рпЖроЯрпНроЯрпБ роХро╛ро░рогрооро╛роХ роорпБро┤рпБ HTML роР роЗроЩрпНроХрпЗ роХро╛роЯрпНроЯро╡ро┐ро▓рпНро▓рпИ
                
                // роОро│ро┐роорпИропро╛рой роорпБроЯро┐ро╡рпБроХро│рпИроХрпН роХро╛роЯрпНроЯрпБроХ
                let html = `
                    <div style="padding: 30px;">
                        <h2 style="color: var(--primary); margin-bottom: 20px; border-bottom: 3px solid var(--secondary); padding-bottom: 10px;">
                            ЁЯУК рокроЩрпНроХро│ро┐рокрпНрокрпБ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роорпБроЯро┐ро╡рпБроХро│рпН
                        </h2>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 30px 0;">
                            <div style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%); color: white; padding: 25px; border-radius: 12px; text-align: center;">
                                <div style="font-size: 36px; font-weight: bold;">${report.summary.totalParticipants}</div>
                                <div style="font-size: 14px; opacity: 0.9;">рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%); color: white; padding: 25px; border-radius: 12px; text-align: center;">
                                <div style="font-size: 36px; font-weight: bold;">${report.summary.totalContributions}</div>
                                <div style="font-size: 14px; opacity: 0.9;">роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #ff9800 0%, #ffb74d 100%); color: white; padding: 25px; border-radius: 12px; text-align: center;">
                                <div style="font-size: 36px; font-weight: bold;">${report.summary.totalProjects}</div>
                                <div style="font-size: 14px; opacity: 0.9;">родро┐роЯрпНроЯроЩрпНроХро│рпН</div>
                            </div>
                        </div>
                        
                        <h3 style="color: var(--primary); margin: 30px 0 15px 0;">ЁЯСе рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпНроХро│рпН</h3>
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background: var(--primary); color: white;">
                                        <th style="padding: 12px; text-align: left;">рокроЩрпНроХро│ро┐рокрпНрокро╛ро│ро░рпН</th>
                                        <th style="padding: 12px; text-align: center;">роорпКродрпНродроорпН</th>
                                        <th style="padding: 12px; text-align: center;">родро┐роЯрпНроЯроЩрпНроХро│рпН</th>
                                        <th style="padding: 12px; text-align: left;">родро┐роЯрпНроЯ ро╡ро┐ро╡ро░роЩрпНроХро│рпН</th>
                                    </tr>
                                </thead>
                                <tbody>`;
                
                report.participants.forEach((p, index) => {
                    const projectDetails = p.projects
                        .map(proj => `<span style="background: #e3f2fd; color: var(--primary); padding: 3px 8px; border-radius: 4px; font-size: 12px; margin: 2px; display: inline-block;">${proj.project}: ${proj.count}</span>`)
                        .join(' ');
                    
                    html += `
                        <tr style="border-bottom: 1px solid #eee; background: ${index % 2 === 0 ? '#f8f9fa' : 'white'}">
                            <td style="padding: 12px;"><strong>${p.username}</strong></td>
                            <td style="padding: 12px; text-align: center; font-weight: bold; color: var(--primary);">${p.total}</td>
                            <td style="padding: 12px; text-align: center;">${p.projectCount}</td>
                            <td style="padding: 12px;">${projectDetails}</td>
                        </tr>`;
                });
                
                html += `
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="margin-top: 40px;">
                            <button onclick="exportResults()" style="background: var(--primary); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">
                                ЁЯУК роорпБроЯро┐ро╡рпБроХро│рпИ роПро▒рпНро▒рпБроородро┐ роЪрпЖропрпНроХ
                            </button>
                            <button onclick="window.print()" style="background: white; color: var(--primary); border: 2px solid var(--primary); padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                ЁЯЦия╕П роЕроЪрпНроЪро┐роЯрпБроХ
                            </button>
                        </div>
                    </div>`;
                
                container.innerHTML = html;
                
                // роорпБро┤рпБ роЕро▒ро┐роХрпНроХрпИ HTML роРроЪрпН роЪрпЗрооро┐роХрпНроХро╡рпБроорпН
                window.lastReport = report;
            }

            showLoading(show, message) {
                updateProgress(show ? 0 : 100, message);
            }

            updateProgress(percentage, message) {
                progressBar.style.width = `${percentage}%`;
                if (message) {
                    progressText.textContent = message;
                }
            }

            showStatus(message, type) {
                showStatus(message, type);
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }
        
        // роорпБроЯро┐ро╡рпБроХро│рпИ роПро▒рпНро▒рпБроородро┐ роЪрпЖропрпНроХ
        function exportResults() {
            if (!window.lastReport) {
                showStatus('роорпБродро▓ро┐ро▓рпН рокроХрпБрокрпНрокро╛ропрпНро╡рпИ роЗропроХрпНроХро╡рпБроорпН', 'warning');
                return;
            }
            
            const jsonString = JSON.stringify(window.lastReport, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `wikimedia-contributions-${new Date().toISOString().slice(0,10)}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showStatus('роорпБроЯро┐ро╡рпБроХро│рпН JSON роЖроХ рокродро┐ро╡ро┐ро▒роХрпНроХроорпН роЪрпЖропрпНропрокрпНрокроЯрпНроЯрой', 'success');
        }
    </script>
</body>
</html>
